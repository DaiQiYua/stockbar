# 实现计划

## 1. 调整显示/不显示分时图时UI渲染宽度的跳变差异

### 问题分析
当前在切换分时图显示状态时，窗口宽度会发生明显的跳变：
- 显示分时图时，宽度自动调整到350px
- 不显示分时图时，宽度自动调整到120px

### 解决方案
1. **优化宽度调整逻辑**：移除强制宽度调整，让用户可以自由设置宽度
2. **平滑过渡**：添加平滑的宽度过渡效果
3. **保留合理的默认值**：根据分时图状态提供合理的默认宽度，但允许用户调整

### 实现步骤
- 修改 `settings.py` 中的 `on_show_chart_change` 方法，移除强制宽度调整
- 调整 `config.py` 中的默认宽度配置，为显示/不显示分时图提供不同的默认值
- 在 `ui.py` 中优化 `recreate_ui` 方法，确保UI元素正确适应不同宽度

## 2. 在股票管理页面输入汉字股票名称获取股票代码

### 问题分析
当前股票管理页面只支持输入股票代码，不支持通过股票名称搜索获取代码。

### 解决方案
1. **添加股票名称搜索功能**：允许用户输入股票名称，自动转换为股票代码
2. **集成股票名称搜索API**：调用第三方API或使用本地数据库进行股票名称到代码的转换
3. **优化股票输入处理**：支持多种输入格式（纯代码、代码+名称、纯名称）

### 实现步骤
- 修改 `stock.py`，添加 `search_stock_by_name` 方法，实现股票名称搜索
- 更新 `settings.py` 中的 `apply_stock_codes` 方法，支持解析股票名称并转换为代码
- 添加股票名称搜索的错误处理和用户反馈

## 3. 只能开启一个设置界面

### 问题分析
当前可以多次打开设置界面，导致界面混乱和资源浪费。

### 解决方案
1. **实现设置界面单例模式**：确保只能打开一个设置窗口
2. **添加窗口状态检查**：在打开设置窗口前检查是否已存在
3. **激活已有窗口**：如果设置窗口已存在，将其激活并置顶，而不是创建新窗口

### 实现步骤
- 在 `core.py` 或 `ui.py` 中添加设置窗口实例的跟踪
- 修改 `ui.py` 中的 `show_settings` 方法，添加单例检查
- 在 `settings.py` 中添加窗口关闭时的清理逻辑

## 实现顺序

1. 首先实现设置界面的单例模式，这是最基础的功能
2. 然后优化分时图显示/隐藏时的宽度跳变问题
3. 最后实现股票名称搜索功能，这需要集成外部API

## 预期效果

1. **设置界面**：只能打开一个设置窗口，重复点击设置按钮会激活已有窗口
2. **分时图切换**：切换分时图显示状态时，窗口宽度保持用户设置的值，或平滑过渡到合理的默认值
3. **股票管理**：支持输入股票名称，自动转换为股票代码，提高用户体验